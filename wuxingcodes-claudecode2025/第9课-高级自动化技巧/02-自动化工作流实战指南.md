# è‡ªåŠ¨åŒ–å·¥ä½œæµå®æˆ˜æŒ‡å—

> **ç”¨é€”**ï¼šClaudeCodeä¸GitHub Actionsé›†æˆçš„å®Œæ•´å®æˆ˜æŒ‡å—
> **ç‰ˆæœ¬**ï¼š2025å¹´12æœˆ
> **ä½œè€…**ï¼šå¤§ç†ŠæŒé—¨

## ğŸ“‹ ç›®å½•
1. [GitHub ActionsåŸºç¡€é…ç½®](#1-github-actionsåŸºç¡€é…ç½®)
2. [PRè‡ªåŠ¨åŒ–å·¥ä½œæµ](#2-prè‡ªåŠ¨åŒ–å·¥ä½œæµ)
3. [CI/CDç›‘æ§ä¸ä¿®å¤](#3-cicdç›‘æ§ä¸ä¿®å¤)
4. [Issueè‡ªåŠ¨å¤„ç†](#4-issueè‡ªåŠ¨å¤„ç†)
5. [æ–‡æ¡£è‡ªåŠ¨æ›´æ–°](#5-æ–‡æ¡£è‡ªåŠ¨æ›´æ–°)
6. [é«˜çº§å·¥ä½œæµæ¨¡å¼](#6-é«˜çº§å·¥ä½œæµæ¨¡å¼)

---

## 1. GitHub ActionsåŸºç¡€é…ç½®

### 1.1 å®‰è£…å’Œè®¾ç½®
```yaml
# .github/workflows/claude-setup.yml
name: Claude Code Setup
on:
  push:
    branches: [main]

jobs:
  setup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Claude Code
        uses: anthropics/claude-code-action@v1
        with:
          action: "setup"
          token: ${{ secrets.CLAUDE_API_TOKEN }}
```

### 1.2 æƒé™é…ç½®
```yaml
# éœ€è¦åœ¨workflowä¸­é…ç½®çš„æƒé™
permissions:
  contents: read
  pull-requests: write
  issues: write
  checks: write
```

### 1.3 ç¯å¢ƒå˜é‡è®¾ç½®
```yaml
env:
  CLAUDE_API_TOKEN: ${{ secrets.CLAUDE_API_TOKEN }}
  CLAUDE_MODEL: "claude-3-opus-20240229"
  CLAUDE_MAX_TOKENS: "4096"
```

---

## 2. PRè‡ªåŠ¨åŒ–å·¥ä½œæµ

### 2.1 åŸºç¡€PRå®¡æŸ¥
```yaml
# .github/workflows/pr-review.yml
name: Claude PR Review
on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  review:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: read

    steps:
      - name: Checkout PR
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Claude Code Review
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            è¯·å¯¹è¿™ä¸ªPull Requestè¿›è¡Œå…¨é¢å®¡æŸ¥ï¼š
            1. ä»£ç è´¨é‡å’Œæœ€ä½³å®è·µ
            2. æ½œåœ¨çš„å®‰å…¨é—®é¢˜
            3. æ€§èƒ½ä¼˜åŒ–å»ºè®®
            4. æµ‹è¯•è¦†ç›–ç‡
            5. æ–‡æ¡£å®Œæ•´æ€§
        token: ${{ secrets.CLAUDE_API_TOKEN }}
```

### 2.2 é«˜çº§PRåˆ†æ
```yaml
# .github/workflows/pr-advanced.yml
name: Advanced PR Analysis
on:
  pull_request:
    branches: [main]

jobs:
  analyze:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        analysis-type: [security, performance, documentation]

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run Analysis
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            ä½œä¸º${{ matrix.analysis-type }}ä¸“å®¶ï¼Œè¯·åˆ†æï¼š
            - ${{ matrix.analysis-type }}ç›¸å…³é—®é¢˜
            - å…·ä½“æ”¹è¿›å»ºè®®
            - ä¼˜å…ˆçº§è¯„ä¼°
        token: ${{ secrets.CLAUDE_API_TOKEN }}

  summary:
    needs: analyze
    runs-on: ubuntu-latest
    steps:
      - name: Generate Summary
        uses: anthropics/claude-code-action@v1
        with:
          prompt: "åŸºäºæ‰€æœ‰åˆ†æç»“æœï¼Œç”ŸæˆPRæ‘˜è¦å’Œæœ€ç»ˆå»ºè®®"
          token: ${{ secrets.CLAUDE_API_TOKEN }}
```

---

## 3. CI/CDç›‘æ§ä¸ä¿®å¤

### 3.1 å¤±è´¥è‡ªåŠ¨è¯Šæ–­
```yaml
# .github/workflows/ci-monitor.yml
name: CI Monitor and Auto-fix
on:
  workflow_run:
    workflows: ["CI"]
    types:
      - completed

jobs:
  monitor:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest

    steps:
      - name: Get Failed Jobs
        id: failed_jobs
        uses: actions/github-script@v7
        with:
          script: |
            const resp = await github.rest.actions.listJobsForWorkflowRun({
              owner: context.repo.owner,
              repo: context.repo.repo,
              run_id: context.payload.workflow_run.id,
            });

            const failed = resp.data.jobs.filter(job => job.conclusion === 'failure');
            return failed.map(job => job.name).join(', ');

      - name: Auto-fix with Claude
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            CIæ„å»ºå¤±è´¥ï¼Œå¤±è´¥çš„ä½œä¸šï¼š${{ steps.failed_jobs.outputs.result }}
            è¯·ï¼š
            1. åˆ†æå¤±è´¥åŸå› 
            2. æä¾›ä¿®å¤æ–¹æ¡ˆ
            3. å¦‚æœå¯èƒ½ï¼Œåˆ›å»ºä¿®å¤PR
        token: ${{ secrets.CLAUDE_API_TOKEN }}
```

### 3.2 æ€§èƒ½å›å½’æ£€æµ‹
```yaml
# .github/workflows/performance-check.yml
name: Performance Regression Check
on:
  pull_request:
    paths: ['**/*.js', '**/*.ts', '**/*.py']

jobs:
  performance:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Run Performance Tests
        run: npm run perf-test

      - name: Analyze with Claude
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            åˆ†ææ€§èƒ½æµ‹è¯•ç»“æœï¼š
            - è¯†åˆ«æ€§èƒ½å›å½’
            - å®šä½ç“¶é¢ˆä»£ç 
            - æä¾›ä¼˜åŒ–å»ºè®®
        token: ${{ secrets.CLAUDE_API_TOKEN }}
```

---

## 4. Issueè‡ªåŠ¨å¤„ç†

### 4.1 Bugè‡ªåŠ¨åˆ†ç±»
```yaml
# .github/workflows/issue-triage.yml
name: Issue Triage
on:
  issues:
    types: [opened, edited]

jobs:
  triage:
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Classify Issue
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            åˆ†æè¿™ä¸ªIssueå¹¶ï¼š
            1. åˆ†ç±»ï¼ˆbug/feature/enhancement/questionï¼‰
            2. ç¡®å®šä¼˜å…ˆçº§
            3. æ·»åŠ ç›¸å…³æ ‡ç­¾
            4. åˆ†é…ç»™åˆé€‚çš„å›¢é˜Ÿ
        token: ${{ secrets.CLAUDE_API_TOKEN }}

      - name: Apply Labels
        uses: actions/github-script@v7
        with:
          script: |
            // Claudeçš„è¾“å‡ºä¼šä½œä¸ºè¾“å…¥
            const labels = '${{ steps.classify.outputs.result }}';
            // åº”ç”¨æ ‡ç­¾é€»è¾‘
```

### 4.2 è‡ªåŠ¨å›å¤FAQ
```yaml
# .github/workflows/issue-faq.yml
name: FAQ Auto-response
on:
  issues:
    types: [opened]

jobs:
  faq:
    if: contains(github.event.issue.labels.*.name, 'question')
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Generate FAQ Response
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            åŸºäºé—®é¢˜å†…å®¹ï¼Œæ£€æŸ¥æ˜¯å¦ä¸ºå¸¸è§é—®é¢˜ï¼š
            - å¦‚æœæ˜¯FAQï¼Œæä¾›è¯¦ç»†ç­”æ¡ˆ
            - å¦‚æœä¸æ˜¯ï¼Œç”Ÿæˆæœ‰ç”¨çš„åˆæ­¥å›å¤
            - å§‹ç»ˆä¿æŒå‹å¥½å’Œå¸®åŠ©çš„æ€åº¦
        token: ${{ secrets.CLAUDE_API_TOKEN }}

      - name: Post Comment
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: '${{ steps.faq.outputs.result }}'
            });
```

---

## 5. æ–‡æ¡£è‡ªåŠ¨æ›´æ–°

### 5.1 APIæ–‡æ¡£ç”Ÿæˆ
```yaml
# .github/workflows/docs-api.yml
name: API Documentation
on:
  push:
    paths: ['**/api/**', '**/*.openapi.yaml']

jobs:
  docs:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Generate API Docs
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            åˆ†æAPIå˜æ›´å¹¶æ›´æ–°æ–‡æ¡£ï¼š
            1. æ£€æŸ¥OpenAPIè§„èŒƒ
            2. è¯†åˆ«æ–°å¢/ä¿®æ”¹çš„ç«¯ç‚¹
            3. ç”Ÿæˆä½¿ç”¨ç¤ºä¾‹
            4. æ›´æ–°ç›¸å…³æ–‡æ¡£
        token: ${{ secrets.CLAUDE_API_TOKEN }}

      - name: Commit Docs
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/
          git commit -m "Auto-update API documentation" || exit 0
          git push
```

### 5.2 READMEè‡ªåŠ¨æ›´æ–°
```yaml
# .github/workflows/update-readme.yml
name: Update README
on:
  push:
    paths: ['package.json', 'requirements.txt', 'go.mod']

jobs:
  update:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Update README
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            ä¾èµ–æ–‡ä»¶å·²æ›´æ–°ï¼Œè¯·ï¼š
            1. æ›´æ–°READMEä¸­çš„å®‰è£…è¯´æ˜
            2. æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯
            3. æ›´æ–°ä¾èµ–åˆ—è¡¨
            4. æ£€æŸ¥æ–‡æ¡£ä¸€è‡´æ€§
        token: ${{ secrets.CLAUDE_API_TOKEN }}
```

---

## 6. é«˜çº§å·¥ä½œæµæ¨¡å¼

### 6.1 å¹¶è¡Œå¤„ç†å·¥ä½œæµ
```yaml
# .github/workflows/parallel-analysis.yml
name: Parallel Code Analysis
on:
  pull_request:

jobs:
  setup:
    runs-on: ubuntu-latest
    outputs:
      files-changed: ${{ steps.changes.outputs.files }}

    steps:
      - name: Get Changed Files
        id: changes
        uses: tj-actions/changed-files@v42
        with:
          files: |
            **/*.js
            **/*.ts
            **/*.py
            **/*.go

  analyze:
    needs: setup
    if: needs.setup.outputs.files-changed != ''
    runs-on: ubuntu-latest
    strategy:
      matrix:
        file: ${{ fromJson(needs.setup.outputs.files-changed) }}

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Analyze File
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            åˆ†ææ–‡ä»¶ ${{ matrix.file }}ï¼š
            - ä»£ç è´¨é‡
            - å®‰å…¨æ£€æŸ¥
            - æ€§èƒ½å½±å“
            - å»ºè®®æ”¹è¿›
        token: ${{ secrets.CLAUDE_API_TOKEN }}

  summarize:
    needs: [setup, analyze]
    if: always() && needs.analyze.result == 'success'
    runs-on: ubuntu-latest

    steps:
      - name: Summarize Results
        uses: anthropics/claude-code-action@v1
        with:
          prompt: "æ±‡æ€»æ‰€æœ‰æ–‡ä»¶åˆ†æç»“æœï¼Œç”Ÿæˆæ•´ä½“è¯„ä¼°æŠ¥å‘Š"
          token: ${{ secrets.CLAUDE_API_TOKEN }}
```

### 6.2 æ¡ä»¶æ‰§è¡Œå·¥ä½œæµ
```yaml
# .github/workflows/conditional.yml
name: Conditional Actions
on:
  pull_request:

jobs:
  check:
    runs-on: ubuntu-latest
    outputs:
      needs-security: ${{ steps.check.outputs.needs-security }}
      needs-performance: ${{ steps.check.outputs.needs-performance }}

    steps:
      - name: Check Requirements
        id: check
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            æ£€æŸ¥PRæ˜¯å¦éœ€è¦ï¼š
            - å®‰å…¨å®¡æŸ¥ï¼ˆè¾“å‡º: needs-security: true/falseï¼‰
            - æ€§èƒ½æµ‹è¯•ï¼ˆè¾“å‡º: needs-performance: true/falseï¼‰

            æ ¼å¼ï¼šneeds-security=true;needs-performance=false
        token: ${{ secrets.CLAUDE_API_TOKEN }}

  security:
    needs: check
    if: needs.check.outputs.needs-security == 'true'
    runs-on: ubuntu-latest

    steps:
      - name: Security Review
        uses: anthropics/claude-code-action@v1
        with:
          prompt: "æ‰§è¡Œå…¨é¢çš„å®‰å…¨å®¡æŸ¥"
          token: ${{ secrets.CLAUDE_API_TOKEN }}

  performance:
    needs: check
    if: needs.check.outputs.needs-performance == 'true'
    runs-on: ubuntu-latest

    steps:
      - name: Performance Test
        uses: anthropics/claude-code-action@v1
        with:
          prompt: "æ‰§è¡Œæ€§èƒ½æµ‹è¯•å’Œåˆ†æ"
          token: ${{ secrets.CLAUDE_API_TOKEN }}
```

### 6.3 å¤šç¯å¢ƒéƒ¨ç½²å·¥ä½œæµ
```yaml
# .github/workflows/multi-env-deploy.yml
name: Multi-Environment Deploy
on:
  push:
    tags: ['v*']

jobs:
  test:
    runs-on: ubuntu-latest
    environment: test

    steps:
      - name: Deploy to Test
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒï¼š
            1. éªŒè¯éƒ¨ç½²é…ç½®
            2. æ‰§è¡Œéƒ¨ç½²æ­¥éª¤
            3. è¿è¡Œå¥åº·æ£€æŸ¥
            4. æŠ¥å‘Šéƒ¨ç½²ç»“æœ
        token: ${{ secrets.CLAUDE_API_TOKEN }}

  staging:
    needs: test
    runs-on: ubuntu-latest
    environment: staging

    steps:
      - name: Deploy to Staging
        uses: anthropics/claude-code-action@v1
        with:
          prompt: "éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒå¹¶éªŒè¯"
          token: ${{ secrets.CLAUDE_API_TOKEN }}

  production:
    needs: staging
    runs-on: ubuntu-latest
    environment: production

    steps:
      - name: Deploy to Production
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼ˆè°¨æ…æ‰§è¡Œï¼‰ï¼š
            1. æœ€ç»ˆé…ç½®éªŒè¯
            2. è“ç»¿éƒ¨ç½²ç­–ç•¥
            3. å…¨é¢ç›‘æ§æ£€æŸ¥
            4. å›æ»šå‡†å¤‡
        token: ${{ secrets.CLAUDE_API_TOKEN }}
```

---

## ğŸ”§ å®ç”¨è„šæœ¬

### ç›‘æ§è„šæœ¬
```bash
#!/bin/bash
# monitor-workflows.sh

REPO="$1"
TOKEN="$2"

# è·å–è¿è¡Œä¸­çš„å·¥ä½œæµ
gh api repos/$REPO/actions/runs --jq '.workflow_runs[] | select(.status == "in_progress") | .name'

# è·å–å¤±è´¥çš„å·¥ä½œæµ
gh api repos/$REPO/actions/runs --jq '.workflow_runs[] | select(.conclusion == "failure") | {name: .name, created_at: .created_at}'
```

### æ‰¹é‡é‡æ–°è¿è¡Œ
```bash
#!/bin/bash
# rerun-failed.sh

REPO="$1"
gh run list --repo $REPO --status failure --limit 10 | \
while read line; do
  run_id=$(echo $line | awk '{print $1}')
  gh run rerun $run_id --repo $REPO
done
```

---

## ğŸ“Š æœ€ä½³å®è·µ

### 1. å·¥ä½œæµè®¾è®¡åŸåˆ™
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå·¥ä½œæµåªåšä¸€ä»¶äº‹
- **å¹‚ç­‰æ€§**ï¼šå¯ä»¥å®‰å…¨åœ°é‡æ–°è¿è¡Œ
- **å¿«é€Ÿå¤±è´¥**ï¼šå°½æ—©å‘ç°å’ŒæŠ¥å‘Šé—®é¢˜
- **æ¸…æ™°æ—¥å¿—**ï¼šæä¾›è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—

### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤å·¥ä½œ
- å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹ä»»åŠ¡
- ä¼˜åŒ–Dockeré•œåƒå¤§å°
- åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´

### 3. å®‰å…¨è€ƒè™‘
- ä½¿ç”¨GitHub Secretsç®¡ç†æ•æ„Ÿä¿¡æ¯
- é™åˆ¶å·¥ä½œæµæƒé™
- å®¡æŸ¥ç¬¬ä¸‰æ–¹Action
- å®šæœŸæ›´æ–°ä¾èµ–

### 4. æˆæœ¬æ§åˆ¶
- ç›‘æ§Actionsä½¿ç”¨é‡
- ä¼˜åŒ–è‡ªæ‰˜ç®¡Runner
- ä½¿ç”¨ç¼“å­˜å‡å°‘å¸¦å®½
- åˆç†è®¾ç½®å¹¶å‘é™åˆ¶

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. Actionæ‰§è¡Œå¤±è´¥
```yaml
- name: Debug Step
  run: |
    echo "Debug information:"
    env
    pwd
    ls -la
```

### 2. æƒé™é—®é¢˜
```yaml
permissions:
  contents: read
  pull-requests: write
  issues: write
```

### 3. è¶…æ—¶é—®é¢˜
```yaml
- name: Long Running Task
  timeout-minutes: 30
  uses: anthropics/claude-code-action@v1
```

---

**ç«‹å³å¼€å§‹æ„å»ºä½ çš„è‡ªåŠ¨åŒ–å·¥ä½œæµï¼Œè®©ClaudeCodeä¸ºä½ çš„CI/CDèµ‹èƒ½ï¼**